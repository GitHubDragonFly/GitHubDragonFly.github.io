<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="encoding" content="utf-8" charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="nunuStudio Examples">
    <link rel="shortcut icon" href="../../images/favicon.ico" type="image/x-icon"/>

    <script async src="https://cdn.jsdelivr.net/npm/es-module-shims@1.10.0/dist/es-module-shims.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/nunu-studio@0.98.45/dist/nunu.min.js" defer></script>

    <style>
      body, html {
        position: relative;
        display: block;
        width: 100%;
        min-height: 100vh;
        border: 0;
        padding: 0;
        margin: 0;
        overflow: hidden;
      }

      button {
        background-color: transparent;
        border: 1px solid blue;
        -webkit-border-radius: 3px;
        border-radius: 3px;
        vertical-align: middle;
        margin: 2px 2px 2px 0;
        min-width: 24px;
        height: 24px;
        padding: 1px;
        color: navy;
      }

      label {
        vertical-align: middle;
        height: 24px;
        margin: 2px 0 2px 0;
      }

      A {
        color:blue;
        text-decoration: none;
        margin: 0 3px 0 3px;
        padding: 0 2px 0 2px;
      }

      A:hover {
        color:red;
        text-decoration: none;
        border: none;
      }

      A:after {
        content: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAQElEQVR42qXKwQkAIAxDUUdxtO6/RBQkQZvSi8I/pL4BoGw/XPkh4XigPmsUgh0626AjRsgxHTkUThsG2T/sIlzdTsp52kSS1wAAAABJRU5ErkJggg==);
        margin: 0 4px 0 4px;
      }

      select {
        vertical-align: middle;
        border: 1px solid blue;
        -webkit-border-radius: 3px;
        border-radius: 3px;
        background: none;
        min-width: 120px;
        height: 24px;
        color: blue;
      }

      .loading_msg {
        background-color: transparent;
        color: red;
        position: absolute;
        text-align: center;
        font-size: x-large;
        width: 50vw;
        height: 50vh;
        top: 50vh;
        left: 25vw;
        padding: 10px;
        border: none;
        z-index: 10;
      }

      p.full_screen {
        text-align: center;
        content: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAf0lEQVRIie1VQQ6AMAjb/x9M4IRePICoK7GLB5eQbElpCTAY7j6YRiUPAvvxbNMkN76XIDhSRKCdjhmB494hzzwngcoBIa/eASgisMgTBo4ODqCTAiSFrW6Biv8LfL/I1DbtfDRV9VLgjVFhZp59A4g+7JaM6yULh7IyWUYX2AAPDxz26GjX+gAAAABJRU5ErkJggg==);
        margin: 1px 1px 1px 2px;
        padding: 0;
        width: 15px;
        height: 15px;
      }

      .fm {
        color: navy;
        width: 99.1%;
        border: 1px solid navy;
        -webkit-border-radius: 2px;
        border-radius: 2px;
        padding: 4px;
        margin: 1px;
      }

      .fixed-menu {
        position: fixed;
        z-index: 1;
        display: inline-block;
        background-color: whitesmoke;
        margin: 0px;
        padding: 1px;
        width: 100%;
      }

      .cnvs {
        background-color: transparent;
        height: 100vh;
        width: 100vw;
        margin: 1px 1px 1px 1px;
        padding: 0;
     }
    </style>

    <!-- Using nunuStudio: https://github.com/tentone/nunuStudio -->

    <title>nunuStudio Examples</title>
  </head>
  <body onload="document_ready();" onresize="resize();">
    <div id="fixed_menu" class="fixed-menu">
      <div class="fm">
        <label for="url_nunu" title="nunuStudio GitHub Page" id="lbl_nunu" style="display: none;">
          <a id="url_nunu" title="nunuStudio GitHub Page" href="https://github.com/tentone/nunuStudio" target="_blank">nunuStudio</a>
        </label>
        <select title="Examples" id="examples">
          <option title="nunuStudio Examples" value="examples" selected disabled>Examples</option>
          <option title="AR Experience" value="ar" onclick="load_example( 'ar' );">AR / VR</option>
          <option title="Boids Experience" value="boids" onclick="load_example( 'boids' );">Boids</option>
          <option title="Flappy Game" value="flappy" onclick="load_example( 'flappy' );">Flappy Game</option>
          <option title="Little Voxel Island Experience" value="littlevoxelisland" onclick="load_example( 'littlevoxelisland' );">Voxel Island</option>
          <option title="Nunu Game" value="nunu" onclick="load_example( 'nunu' );">Nunu Game</option>
          <option title="Paint Experience" value="paint" onclick="load_example( 'paint' );">Paint</option>
          <option title="PBR Experience" value="pbr" onclick="load_example( 'pbr' );">PBR</option>
          <option title="Pong Game" value="pong" onclick="load_example( 'pong' );">Pong Game</option>
          <option title="Portal Game" value="portal" onclick="load_example( 'portal' );">Portal Game</option>
          <option title="Roller Coaster Experience" value="rollercoaster" onclick="load_example( 'rollercoaster' );">Roller Coaster</option>
          <option title="Star Wars Experience" value="starwars" onclick="load_example( 'starwars' );">Star Wars</option>
        </select>
        <button id="btn_pause_resume" title="Pause and Resume" onclick="pause_resume()" disabled >||</button>
        <button id="btn_ar" title="AR - Augmented Reality" onclick="ar_mode()" style="min-width: 28px;" disabled >AR</button>
        <button id="btn_vr" title="VR - Virtual Reality" onclick="vr_mode()" style="min-width: 28px;" disabled >VR</button>
        <button id="btn_full_screen" title="Full Screen" onclick="full_screen()" style="float: inline-end; display: none;">
          <p class="full_screen"></p>
        </button>
      </div>
    </div><br />

    <div id="div_message" class="loading_msg">Select Example</div>

    <script>
      function initialize_event_listeners() {
        window.addEventListener( 'pointerdown', ( event ) => {}, false);
        window.addEventListener( 'pointerup', ( event ) => {}, false);
        window.addEventListener( 'wheel', ( event ) => {}, false);
      }

      function resize() {
        if (window.fullScreen || document.fullscreenElement || document.mozFullScreenElement ||
          document.msFullscreenElement || document.webkitFullscreenElement) {

          document.getElementById('btn_full_screen').style.backgroundColor = '#FFFF00';
        } else {
          document.getElementById('btn_full_screen').style.backgroundColor = 'transparent';
        }

        if (example_loaded === true) {
          loaded_app.canvas.width = window.innerWidth + "px";
          loaded_app.canvas.height = window.innerHeight + "px";

          loaded_app.resize();
        }
      }

      function full_screen() {
        if (document.fullscreenEnabled) {
          document.fullscreenElement ? document.exitFullscreen() : document.body.requestFullscreen();
        } else if (document.mozFullScreenEnabled) {
          document.mozFullScreenElement ? document.mozCancelFullScreen() : document.body.mozRequestFullScreen();
        } else if (document.msFullscreenEnabled) {
          document.msFullscreenElement ? document.msExitFullscreen() : document.body.msRequestFullscreen();
        } else if (document.webkitFullscreenEnabled) {
          document.webkitFullscreenElement ? document.webkitExitFullscreen() : document.body.webkitRequestFullscreen();
        } else if (window.fullScreen) {
          // Do nothing. This fullscreen mode was triggered with F11 key press and requires the same again.
        }
      }
    </script>

    <script>
      var loaded_app, example_loaded = false, links, events_initialized;
      var ar_mode_enabled = false, vr_mode_enabled = false, isMobile;

      async function pause_resume() {
        if ($('#btn_pause_resume')[ 0 ].disabled === false) {
          if (loaded_app.running === true) {
            await loaded_app.pause();
            $('#btn_pause_resume')[ 0 ].innerText = '>';
          } else {
            await loaded_app.resume();
            $('#btn_pause_resume')[ 0 ].innerText = '||';
          }
        }
      }

      function ar_mode() {
        if (loaded_app) {
          if (ar_mode_enabled === true) {
            ar_mode_enabled = false;
            document.getElementById('btn_ar').style.backgroundColor = 'transparent';
          } else {
            ar_mode_enabled = true;
            document.getElementById('btn_ar').style.backgroundColor = 'lightgreen';
          }

          loaded_app.toggleAR();
        }
      }

      function vr_mode() {
        if (loaded_app) {
          if (vr_mode_enabled === true) {
            vr_mode_enabled = false;
            document.getElementById('btn_vr').style.backgroundColor = 'transparent';
          } else {
            vr_mode_enabled = true;
            document.getElementById('btn_vr').style.backgroundColor = 'lightgreen';
          }

          loaded_app.toggleVR();
        }
      }

      async function app_dispose() {
        $('#btn_pause_resume')[ 0 ].disabled = true;
        $('#btn_pause_resume')[ 0 ].innerText = '||';

        disabled_changed();

        if (loaded_app.running === true) await loaded_app.pause();
        if (loaded_app.program) await loaded_app.program.dispose();
        await loaded_app.exit();
      }

      async function load_example( example ) {
        $('#div_message')[ 0 ].innerText = 'Example Loading';
        $('#div_message')[ 0 ].style.display = '';

        if (example_loaded === true) {
          await app_dispose();
          document.body.removeChild( document.getElementById('canvas') );
        }


        let canvas = document.createElement( 'canvas' );
        canvas.setAttribute('class', 'cnvs');
        canvas.setAttribute('id', 'canvas');
        document.body.appendChild( canvas );

        loaded_app = new Nunu.App( document.getElementById('canvas') );
        loaded_app.canvasFitWindow = true;

        await loaded_app.loadRunProgram(
          links[ example ],
          function( app ) { // onLoad
            $('#btn_pause_resume')[ 0 ].disabled = false;
            $('#div_message')[ 0 ].innerText = '';
            $('#div_message')[ 0 ].style.display = 'none';

            if (example_loaded === false) {
              example_loaded = true;
              document.getElementById('div_message').style.display = 'none';
            }

            loaded_app.renderer.xr.enabled = true;

            document.getElementById('btn_ar').style.backgroundColor = 'transparent';

            if (loaded_app.arAvailable() === true) {
              document.getElementById('btn_ar').style.display = '';
              document.getElementById('btn_ar').disabled = false;
            } else {
              document.getElementById('btn_ar').disabled = true;
              document.getElementById('btn_ar').style.display = 'none';
            }

            document.getElementById('btn_vr').style.backgroundColor = 'transparent';

            if (loaded_app.vrAvailable() === true) {
              document.getElementById('btn_vr').style.display = '';
              document.getElementById('btn_vr').disabled = false;
            } else {
              document.getElementById('btn_vr').disabled = true;
              document.getElementById('btn_vr').style.display = 'none';
            }

            disabled_changed();
            resize();
          },
          function( progress, event ) {} // onProgress
        );
      }
    </script>

    <script>
      async function document_ready() {
        isMobile = (/iPad|iPhone|iPod/.test( navigator.platform )) ||
          (/Android|webOS|iPhone|iPad|iPod|CriOS|BlackBerry|IEMobile|Opera Mini/i.test( navigator.userAgent )) ||
          (navigator.maxTouchPoints !== undefined && navigator.maxTouchPoints > 2 && /MacIntel/.test( navigator.platform ));

        links = {
          ar: 'https://raw.githubusercontent.com/tentone/nunuStudio/master/source/page/src/examples/ar.nsp',
          boids: 'https://raw.githubusercontent.com/tentone/nunuStudio/master/source/page/src/examples/boids.nsp',
          nunu: 'https://raw.githubusercontent.com/tentone/nunuStudio/master/source/page/src/examples/nunu.nsp',
          flappy: 'https://raw.githubusercontent.com/tentone/nunuStudio/master/source/page/src/examples/flappy.nsp',
          littlevoxelisland: 'https://raw.githubusercontent.com/tentone/nunuStudio/master/source/page/src/examples/littlevoxelisland.nsp',
          paint: 'https://raw.githubusercontent.com/tentone/nunuStudio/master/source/page/src/examples/paint.nsp',
          pbr: 'https://raw.githubusercontent.com/tentone/nunuStudio/master/source/page/src/examples/pbr.nsp',
          pong: 'https://raw.githubusercontent.com/tentone/nunuStudio/master/source/page/src/examples/pong.nsp',
          portal: 'https://raw.githubusercontent.com/tentone/nunuStudio/master/source/page/src/examples/portal.nsp',
          rollercoaster: 'https://raw.githubusercontent.com/tentone/nunuStudio/master/source/page/src/examples/rollercoaster.nsp',
          starwars: 'https://raw.githubusercontent.com/tentone/nunuStudio/master/source/page/src/examples/starwars.nsp'
        };

        if (navigator.userAgent.indexOf('Chrome') > -1 || navigator.userAgent.indexOf('Safari') > -1 || isMobile === true) {
          $('#examples').change( function() { $(this).children(':selected').click(); });
        }

        if (isMobile === false) {
          $('#lbl_nunu')[ 0 ].style.display = '';
          $('#btn_full_screen')[ 0 ].style.display = '';
        }

        if (example_loaded === true) await app_dispose();

        example_loaded = false;

        document.getElementById('examples').selectedIndex = 0;

        if (!events_initialized) { initialize_event_listeners(); events_initialized = true; }

        $('#btn_pause_resume')[ 0 ].disabled = true;
        $('#btn_pause_resume')[ 0 ].innerText = '||';

        document.getElementById('btn_ar').style.backgroundColor = 'transparent';
        document.getElementById('btn_vr').style.backgroundColor = 'transparent';

        disabled_changed();
      }

      function disabled_changed() {
        $('button').each( function() {
          if (this.disabled === false) {
            $(this).hover(
            function() { $(this)[ 0 ].style.border = 'solid 2px red'; },
            function() { $(this)[ 0 ].style.border = 'solid 1px blue'; });
          } else {
            $(this).unbind('mouseenter mouseleave');
          }
        });

        $('select').each( function() {
          if (this.disabled === false) {
            $(this).hover(
            function() { $(this)[ 0 ].style.border = 'solid 2px red'; },
            function() { $(this)[ 0 ].style.border = 'solid 1px blue'; });
          } else {
            $(this).unbind('mouseenter mouseleave');
          }
        });
      }
    </script>
  </body>
</html>
