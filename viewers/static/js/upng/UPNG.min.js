var UPNG=function(){var _bin={nextZero:function(data,p){for(;0!=data[p];)p++;return p},readUshort:function(buff,p){return buff[p]<<8|buff[p+1]},writeUshort:function(buff,p,n){buff[p]=n>>8&255,buff[p+1]=255&n},readUint:function(buff,p){return 16777216*buff[p]+(buff[p+1]<<16|buff[p+2]<<8|buff[p+3])},writeUint:function(buff,p,n){buff[p]=n>>24&255,buff[p+1]=n>>16&255,buff[p+2]=n>>8&255,buff[p+3]=255&n},readASCII:function(buff,p,l){for(var s="",i=0;i<l;i++)s+=String.fromCharCode(buff[p+i]);return s},writeASCII:function(data,p,s){for(var i=0;i<s.length;i++)data[p+i]=s.charCodeAt(i)},readBytes:function(buff,p,l){for(var arr=[],i=0;i<l;i++)arr.push(buff[p+i]);return arr},pad:function(n){return n.length<2?"0"+n:n},readUTF8:function(buff,p,l){for(var s="",ns,i=0;i<l;i++)s+="%"+_bin.pad(buff[p+i].toString(16));try{ns=decodeURIComponent(s)}catch(e){return _bin.readASCII(buff,p,l)}return ns}};function toRGBA8(out){var w=out.width,h=out.height;if(null==out.tabs.acTL)return[decodeImage(out.data,w,h,out).buffer];var frms=[];null==out.frames[0].data&&(out.frames[0].data=out.data);for(var len=w*h*4,img=new Uint8Array(len),empty=new Uint8Array(len),prev=new Uint8Array(len),i=0;i<out.frames.length;i++){var frm=out.frames[i],fx=frm.rect.x,fy=frm.rect.y,fw=frm.rect.width,fh=frm.rect.height,fdata=decodeImage(frm.data,fw,fh,out);if(0!=i)for(var j=0;j<len;j++)prev[j]=img[j];if(0==frm.blend?_copyTile(fdata,fw,fh,img,w,h,fx,fy,0):1==frm.blend&&_copyTile(fdata,fw,fh,img,w,h,fx,fy,1),frms.push(img.buffer.slice(0)),0==frm.dispose);else if(1==frm.dispose)_copyTile(empty,fw,fh,img,w,h,fx,fy,0);else if(2==frm.dispose)for(var j=0;j<len;j++)img[j]=prev[j]}return frms}function decodeImage(data,w,h,out){var area=w*h,bpp=_getBPP(out),bpl=Math.ceil(w*bpp/8),bf=new Uint8Array(4*area),bf32=new Uint32Array(bf.buffer),ctype=out.ctype,depth=out.depth,rs=_bin.readUshort,time=Date.now();if(6==ctype){var qarea=area<<2;if(8==depth)for(var i=0;i<qarea;i+=4)bf[i]=data[i],bf[i+1]=data[i+1],bf[i+2]=data[i+2],bf[i+3]=data[i+3];if(16==depth)for(var i=0;i<qarea;i++)bf[i]=data[i<<1]}else if(2==ctype){var ts=out.tabs.tRNS;if(null==ts){if(8==depth)for(var i=0;i<area;i++){var ti=3*i;bf32[i]=255<<24|data[ti+2]<<16|data[ti+1]<<8|data[ti]}if(16==depth)for(var i=0;i<area;i++){var ti=6*i;bf32[i]=255<<24|data[ti+4]<<16|data[ti+2]<<8|data[ti]}}else{var tr=ts[0],tg=ts[1],tb=ts[2];if(8==depth)for(var i=0;i<area;i++){var qi=i<<2,ti=3*i;bf32[i]=255<<24|data[ti+2]<<16|data[ti+1]<<8|data[ti],data[ti]==tr&&data[ti+1]==tg&&data[ti+2]==tb&&(bf[qi+3]=0)}if(16==depth)for(var i=0;i<area;i++){var qi=i<<2,ti=6*i;bf32[i]=255<<24|data[ti+4]<<16|data[ti+2]<<8|data[ti],rs(data,ti)==tr&&rs(data,ti+2)==tg&&rs(data,ti+4)==tb&&(bf[qi+3]=0)}}}else if(3==ctype){var p=out.tabs.PLTE,ap=out.tabs.tRNS,tl=ap?ap.length:0;if(1==depth)for(var y=0;y<h;y++)for(var s0=y*bpl,t0=y*w,i=0;i<w;i++){var qi=t0+i<<2,j,cj=3*(j=data[s0+(i>>3)]>>7-((7&i)<<0)&1);bf[qi]=p[cj],bf[qi+1]=p[cj+1],bf[qi+2]=p[cj+2],bf[qi+3]=j<tl?ap[j]:255}if(2==depth)for(var y=0;y<h;y++)for(var s0=y*bpl,t0=y*w,i=0;i<w;i++){var qi=t0+i<<2,j,cj=3*(j=data[s0+(i>>2)]>>6-((3&i)<<1)&3);bf[qi]=p[cj],bf[qi+1]=p[cj+1],bf[qi+2]=p[cj+2],bf[qi+3]=j<tl?ap[j]:255}if(4==depth)for(var y=0;y<h;y++)for(var s0=y*bpl,t0=y*w,i=0;i<w;i++){var qi=t0+i<<2,j,cj=3*(j=data[s0+(i>>1)]>>4-((1&i)<<2)&15);bf[qi]=p[cj],bf[qi+1]=p[cj+1],bf[qi+2]=p[cj+2],bf[qi+3]=j<tl?ap[j]:255}if(8==depth)for(var i=0;i<area;i++){var qi=i<<2,j,cj=3*(j=data[i]);bf[qi]=p[cj],bf[qi+1]=p[cj+1],bf[qi+2]=p[cj+2],bf[qi+3]=j<tl?ap[j]:255}}else if(4==ctype){if(8==depth)for(var i=0;i<area;i++){var qi=i<<2,di,gr=data[di=i<<1];bf[qi]=gr,bf[qi+1]=gr,bf[qi+2]=gr,bf[qi+3]=data[di+1]}if(16==depth)for(var i=0;i<area;i++){var qi=i<<2,di,gr=data[di=i<<2];bf[qi]=gr,bf[qi+1]=gr,bf[qi+2]=gr,bf[qi+3]=data[di+2]}}else if(0==ctype)for(var tr=out.tabs.tRNS?out.tabs.tRNS:-1,y=0;y<h;y++){var off=y*bpl,to=y*w;if(1==depth)for(var x=0;x<w;x++){var gr,al=(gr=255*(data[off+(x>>>3)]>>>7-(7&x)&1))==255*tr?0:255;bf32[to+x]=al<<24|gr<<16|gr<<8|gr}else if(2==depth)for(var x=0;x<w;x++){var gr,al=(gr=85*(data[off+(x>>>2)]>>>6-((3&x)<<1)&3))==85*tr?0:255;bf32[to+x]=al<<24|gr<<16|gr<<8|gr}else if(4==depth)for(var x=0;x<w;x++){var gr,al=(gr=17*(data[off+(x>>>1)]>>>4-((1&x)<<2)&15))==17*tr?0:255;bf32[to+x]=al<<24|gr<<16|gr<<8|gr}else if(8==depth)for(var x=0;x<w;x++){var gr,al=(gr=data[off+x])==tr?0:255;bf32[to+x]=al<<24|gr<<16|gr<<8|gr}else if(16==depth)for(var x=0;x<w;x++){var gr=data[off+(x<<1)],al=rs(data,off+(x<<1))==tr?0:255;bf32[to+x]=al<<24|gr<<16|gr<<8|gr}}return bf}function decode(buff){for(var data=new Uint8Array(buff),offset=8,bin=_bin,rUs=bin.readUshort,rUi=bin.readUint,out={tabs:{},frames:[]},dd=new Uint8Array(data.length),doff=0,fd,foff=0,mgck=[137,80,78,71,13,10,26,10],i=0,fr;i<8;i++)if(data[i]!=mgck[i])throw"The input is not a PNG file!";for(;offset<data.length;){var len=bin.readUint(data,offset);offset+=4;var type=bin.readASCII(data,offset,4);if(offset+=4,"IHDR"==type)_IHDR(data,offset,out);else if("iCCP"==type){for(var off=offset;0!=data[off];)off++;var nam=bin.readASCII(data,offset,off-offset),cpr=data[off+1],fil=data.slice(off+2,offset+len),res=null;try{res=_inflate(fil)}catch(e){res=inflateRaw(fil)}out.tabs[type]=res}else if("CgBI"==type)out.tabs[type]=data.slice(offset,offset+4);else if("IDAT"==type){for(var i=0;i<len;i++)dd[doff+i]=data[offset+i];doff+=len}else if("acTL"==type)out.tabs[type]={num_frames:rUi(data,offset),num_plays:rUi(data,offset+4)},fd=new Uint8Array(data.length);else if("fcTL"==type){var fr;if(0!=foff)(fr=out.frames[out.frames.length-1]).data=_decompress(out,fd.slice(0,foff),fr.rect.width,fr.rect.height),foff=0;var rct={x:rUi(data,offset+12),y:rUi(data,offset+16),width:rUi(data,offset+4),height:rUi(data,offset+8)},del=rUs(data,offset+22);del=rUs(data,offset+20)/(0==del?100:del);var frm={rect:rct,delay:Math.round(1e3*del),dispose:data[offset+24],blend:data[offset+25]};out.frames.push(frm)}else if("fdAT"==type){for(var i=0;i<len-4;i++)fd[foff+i]=data[offset+i+4];foff+=len-4}else if("pHYs"==type)out.tabs[type]=[bin.readUint(data,offset),bin.readUint(data,offset+4),data[offset+8]];else if("cHRM"==type){out.tabs[type]=[];for(var i=0;i<8;i++)out.tabs[type].push(bin.readUint(data,offset+4*i))}else if("tEXt"==type||"zTXt"==type){null==out.tabs[type]&&(out.tabs[type]={});var nz=bin.nextZero(data,offset),keyw=bin.readASCII(data,offset,nz-offset),text,tl=offset+len-nz-1;if("tEXt"==type)text=bin.readASCII(data,nz+1,tl);else{var bfr=_inflate(data.slice(nz+2,nz+2+tl));text=bin.readUTF8(bfr,0,bfr.length)}out.tabs[type][keyw]=text}else if("iTXt"==type){null==out.tabs[type]&&(out.tabs[type]={});var nz=0,off=offset;nz=bin.nextZero(data,off);var keyw=bin.readASCII(data,off,nz-off),cflag=data[off=nz+1],cmeth=data[off+1];off+=2,nz=bin.nextZero(data,off);var ltag=bin.readASCII(data,off,nz-off);off=nz+1,nz=bin.nextZero(data,off);var tkeyw=bin.readUTF8(data,off,nz-off),text,tl=len-((off=nz+1)-offset);if(0==cflag)text=bin.readUTF8(data,off,tl);else{var bfr=_inflate(data.slice(off,off+tl));text=bin.readUTF8(bfr,0,bfr.length)}out.tabs[type][keyw]=text}else if("PLTE"==type)out.tabs[type]=bin.readBytes(data,offset,len);else if("hIST"==type){var pl=out.tabs.PLTE.length/3;out.tabs[type]=[];for(var i=0;i<pl;i++)out.tabs[type].push(rUs(data,offset+2*i))}else if("tRNS"==type)3==out.ctype?out.tabs[type]=bin.readBytes(data,offset,len):0==out.ctype?out.tabs[type]=rUs(data,offset):2==out.ctype&&(out.tabs[type]=[rUs(data,offset),rUs(data,offset+2),rUs(data,offset+4)]);else if("gAMA"==type)out.tabs[type]=bin.readUint(data,offset)/1e5;else if("sRGB"==type)out.tabs[type]=data[offset];else if("bKGD"==type)0==out.ctype||4==out.ctype?out.tabs[type]=[rUs(data,offset)]:2==out.ctype||6==out.ctype?out.tabs[type]=[rUs(data,offset),rUs(data,offset+2),rUs(data,offset+4)]:3==out.ctype&&(out.tabs[type]=data[offset]);else if("IEND"==type)break;offset+=len;var crc=bin.readUint(data,offset);offset+=4}0!=foff&&((fr=out.frames[out.frames.length-1]).data=_decompress(out,fd.slice(0,foff),fr.rect.width,fr.rect.height));return out.data=_decompress(out,dd,out.width,out.height),delete out.compress,delete out.interlace,delete out.filter,out}function _decompress(out,dd,w,h){var time=Date.now(),bpp=_getBPP(out),bpl=Math.ceil(w*bpp/8),buff=new Uint8Array((bpl+1+out.interlace)*h);dd=out.tabs.CgBI?inflateRaw(dd,buff):_inflate(dd,buff);var time=Date.now();return 0==out.interlace?dd=_filterZero(dd,out,0,w,h):1==out.interlace&&(dd=_readInterlace(dd,out)),dd}function _inflate(data,buff){var out;return inflateRaw(new Uint8Array(data.buffer,2,data.length-6),buff)}var inflateRaw=((H={}).H={},H.H.N=function(N,W){var R=Uint8Array,i=0,m=0,J=0,h=0,Q=0,X=0,u=0,w=0,d=0,v,C;if(3==N[0]&&0==N[1])return W||new R(0);var V=H.H,n=V.b,A=V.e,l=V.R,M=V.n,I=V.A,e=V.Z,b=V.m,Z=null==W;for(Z&&(W=new R(N.length>>>2<<5));0==i;)if(i=n(N,d,1),m=n(N,d+1,2),d+=3,0!=m){if(Z&&(W=H.H.W(W,w+(1<<17))),1==m&&(v=b.J,C=b.h,X=511,u=31),2==m){J=A(N,d,5)+257,h=A(N,d+5,5)+1,Q=A(N,d+10,4)+4;for(var E=d+=14,j=1,c=0;c<38;c+=2)b.Q[c]=0,b.Q[c+1]=0;for(var c=0;c<Q;c++){var K=A(N,d+3*c,3);b.Q[1+(b.X[c]<<1)]=K,K>j&&(j=K)}d+=3*Q,M(b.Q,j),I(b.Q,j,b.u),v=b.w,C=b.d,d=l(b.u,(1<<j)-1,J+h,N,d,b.v);var r=V.V(b.v,0,J,b.C);X=(1<<r)-1;var S=V.V(b.v,J,h,b.D);u=(1<<S)-1,M(b.C,r),I(b.C,r,v),M(b.D,S),I(b.D,S,C)}for(;;){var T=v[e(N,d)&X];d+=15&T;var p=T>>>4;if(p>>>8==0)W[w++]=p;else{if(256==p)break;var z=w+p-254;if(p>264){var _=b.q[p-257];z=w+(_>>>3)+A(N,d,7&_),d+=7&_}var $=C[e(N,d)&u];d+=15&$;var s=$>>>4,Y=b.c[s],a=(Y>>>4)+n(N,d,15&Y);for(d+=15&Y;w<z;)W[w]=W[w++-a],W[w]=W[w++-a],W[w]=W[w++-a],W[w]=W[w++-a];w=z}}}else{0!=(7&d)&&(d+=8-(7&d));var D=4+(d>>>3),q=N[D-4]|N[D-3]<<8;Z&&(W=H.H.W(W,w+q)),W.set(new R(N.buffer,N.byteOffset+D,q),w),d=D+q<<3,w+=q}return W.length==w?W:W.slice(0,w)},H.H.W=function(N,W){var R=N.length;if(W<=R)return N;var V=new Uint8Array(R<<1);return V.set(N,0),V},H.H.R=function(N,W,R,V,n,A){for(var l=H.H.e,M=H.H.Z,I=0;I<R;){var e=N[M(V,n)&W];n+=15&e;var b=e>>>4;if(b<=15)A[I]=b,I++;else{var Z=0,m=0;16==b?(m=3+l(V,n,2),n+=2,Z=A[I-1]):17==b?(m=3+l(V,n,3),n+=3):18==b&&(m=11+l(V,n,7),n+=7);for(var J=I+m;I<J;)A[I]=Z,I++}}return n},H.H.V=function(N,W,R,V){for(var n=0,A=0,l=V.length>>>1;A<R;){var M=N[A+W];V[A<<1]=0,V[1+(A<<1)]=M,M>n&&(n=M),A++}for(;A<l;)V[A<<1]=0,V[1+(A<<1)]=0,A++;return n},H.H.n=function(N,W){for(var R=H.H.m,V=N.length,n,A,l,M,I,e=R.j,M=0;M<=W;M++)e[M]=0;for(M=1;M<V;M+=2)e[N[M]]++;var b=R.K;for(n=0,e[0]=0,A=1;A<=W;A++)n=n+e[A-1]<<1,b[A]=n;for(l=0;l<V;l+=2)0!=(I=N[l+1])&&(N[l]=b[I],b[I]++)},H.H.A=function(N,W,R){for(var V=N.length,n,A=H.H.m.r,l=0;l<V;l+=2)if(0!=N[l+1])for(var M=l>>1,I=N[l+1],e=M<<4|I,b=W-I,Z=N[l]<<b,m=Z+(1<<b);Z!=m;){var J;R[A[Z]>>>15-W]=e,Z++}},H.H.l=function(N,W){for(var R=H.H.m.r,V=15-W,n=0;n<N.length;n+=2){var A=N[n]<<W-N[n+1];N[n]=R[A]>>>V}},H.H.M=function(N,W,R){R<<=7&W;var V=W>>>3;N[V]|=R,N[V+1]|=R>>>8},H.H.I=function(N,W,R){R<<=7&W;var V=W>>>3;N[V]|=R,N[V+1]|=R>>>8,N[V+2]|=R>>>16},H.H.e=function(N,W,R){return(N[W>>>3]|N[1+(W>>>3)]<<8)>>>(7&W)&(1<<R)-1},H.H.b=function(N,W,R){return(N[W>>>3]|N[1+(W>>>3)]<<8|N[2+(W>>>3)]<<16)>>>(7&W)&(1<<R)-1},H.H.Z=function(N,W){return(N[W>>>3]|N[1+(W>>>3)]<<8|N[2+(W>>>3)]<<16)>>>(7&W)},H.H.i=function(N,W){return(N[W>>>3]|N[1+(W>>>3)]<<8|N[2+(W>>>3)]<<16|N[3+(W>>>3)]<<24)>>>(7&W)},H.H.m=(N=Uint16Array,W=Uint32Array,{K:new N(16),j:new N(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new N(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new W(32),J:new N(512),_:[],h:new N(32),$:[],w:new N(32768),C:[],v:[],d:new N(32768),D:[],u:new N(512),Q:[],r:new N(32768),s:new W(286),Y:new W(30),a:new W(19),t:new W(15e3),k:new N(65536),g:new N(32768)}),function(){for(var N=H.H.m,W=32768,R=0;R<W;R++){var V=R;V=(4278255360&(V=(4042322160&(V=(3435973836&(V=(2863311530&V)>>>1|(1431655765&V)<<1))>>>2|(858993459&V)<<2))>>>4|(252645135&V)<<4))>>>8|(16711935&V)<<8,N.r[R]=(V>>>16|V<<16)>>>17}function n(A,l,M){for(;0!=l--;)A.push(0,M)}for(var R=0;R<32;R++)N.q[R]=N.S[R]<<3|N.T[R],N.c[R]=N.p[R]<<4|N.z[R];n(N._,144,8),n(N._,112,9),n(N._,24,7),n(N._,8,8),H.H.n(N._,9),H.H.A(N._,9,N.J),H.H.l(N._,9),n(N.$,32,5),H.H.n(N.$,5),H.H.A(N.$,5,N.h),H.H.l(N.$,5),n(N.Q,19,0),n(N.C,286,0),n(N.D,30,0),n(N.v,320,0)}(),H.H.N),H,N,W;function _readInterlace(data,out){for(var w=out.width,h=out.height,bpp=_getBPP(out),cbpp=bpp>>3,bpl=Math.ceil(w*bpp/8),img=new Uint8Array(h*bpl),di=0,starting_row=[0,0,4,0,2,0,1],starting_col=[0,4,0,2,0,1,0],row_increment=[8,8,8,4,4,2,2],col_increment=[8,8,4,4,2,2,1],pass=0;pass<7;){for(var ri=row_increment[pass],ci=col_increment[pass],sw=0,sh=0,cr=starting_row[pass];cr<h;)cr+=ri,sh++;for(var cc=starting_col[pass];cc<w;)cc+=ci,sw++;var bpll=Math.ceil(sw*bpp/8);_filterZero(data,out,di,sw,sh);for(var y=0,row=starting_row[pass];row<h;){for(var col=starting_col[pass],cdi=di+y*bpll<<3;col<w;){var val,val,val;if(1==bpp)val=(val=data[cdi>>3])>>7-(7&cdi)&1,img[row*bpl+(col>>3)]|=val<<7-((7&col)<<0);if(2==bpp)val=(val=data[cdi>>3])>>6-(7&cdi)&3,img[row*bpl+(col>>2)]|=val<<6-((3&col)<<1);if(4==bpp)val=(val=data[cdi>>3])>>4-(7&cdi)&15,img[row*bpl+(col>>1)]|=val<<4-((1&col)<<2);if(bpp>=8)for(var ii=row*bpl+col*cbpp,j=0;j<cbpp;j++)img[ii+j]=data[(cdi>>3)+j];cdi+=bpp,col+=ci}y++,row+=ri}sw*sh!=0&&(di+=sh*(1+bpll)),pass+=1}return img}function _getBPP(out){var noc;return[1,null,3,1,2,null,4][out.ctype]*out.depth}function _filterZero(data,out,off,w,h){var bpp=_getBPP(out),bpl=Math.ceil(w*bpp/8);bpp=Math.ceil(bpp/8);var i,di,type=data[off],x=0;if(type>1&&(data[off]=[0,0,1][type-2]),3==type)for(x=bpp;x<bpl;x++)data[x+1]=data[x+1]+(data[x+1-bpp]>>>1)&255;for(var y=0;y<h;y++)if(x=0,0==(type=data[(di=(i=off+y*bpl)+y+1)-1]))for(;x<bpl;x++)data[i+x]=data[di+x];else if(1==type){for(;x<bpp;x++)data[i+x]=data[di+x];for(;x<bpl;x++)data[i+x]=data[di+x]+data[i+x-bpp]}else if(2==type)for(;x<bpl;x++)data[i+x]=data[di+x]+data[i+x-bpl];else if(3==type){for(;x<bpp;x++)data[i+x]=data[di+x]+(data[i+x-bpl]>>>1);for(;x<bpl;x++)data[i+x]=data[di+x]+(data[i+x-bpl]+data[i+x-bpp]>>>1)}else{for(;x<bpp;x++)data[i+x]=data[di+x]+_paeth(0,data[i+x-bpl],0);for(;x<bpl;x++)data[i+x]=data[di+x]+_paeth(data[i+x-bpp],data[i+x-bpl],data[i+x-bpp-bpl])}return data}function _paeth(a,b,c){var p=a+b-c,pa=p-a,pb=p-b,pc=p-c;return pa*pa<=pb*pb&&pa*pa<=pc*pc?a:pb*pb<=pc*pc?b:c}function _IHDR(data,offset,out){out.width=_bin.readUint(data,offset),offset+=4,out.height=_bin.readUint(data,offset),offset+=4,out.depth=data[offset],offset++,out.ctype=data[offset],offset++,out.compress=data[offset],offset++,out.filter=data[offset],offset++,out.interlace=data[offset],offset++}function _copyTile(sb,sw,sh,tb,tw,th,xoff,yoff,mode){for(var w=Math.min(sw,tw),h=Math.min(sh,th),si=0,ti=0,y=0;y<h;y++)for(var x=0;x<w;x++)if(xoff>=0&&yoff>=0?(si=y*sw+x<<2,ti=(yoff+y)*tw+xoff+x<<2):(si=(-yoff+y)*sw-xoff+x<<2,ti=y*tw+x<<2),0==mode)tb[ti]=sb[si],tb[ti+1]=sb[si+1],tb[ti+2]=sb[si+2],tb[ti+3]=sb[si+3];else if(1==mode){var fa=sb[si+3]*(1/255),fr=sb[si]*fa,fg=sb[si+1]*fa,fb=sb[si+2]*fa,ba=tb[ti+3]*(1/255),br=tb[ti]*ba,bg=tb[ti+1]*ba,bb=tb[ti+2]*ba,ifa=1-fa,oa=fa+ba*ifa,ioa=0==oa?0:1/oa;tb[ti+3]=255*oa,tb[ti+0]=(fr+br*ifa)*ioa,tb[ti+1]=(fg+bg*ifa)*ioa,tb[ti+2]=(fb+bb*ifa)*ioa}else if(2==mode){var fa=sb[si+3],fr=sb[si],fg=sb[si+1],fb=sb[si+2],ba=tb[ti+3],br=tb[ti],bg=tb[ti+1],bb=tb[ti+2];fa==ba&&fr==br&&fg==bg&&fb==bb?(tb[ti]=0,tb[ti+1]=0,tb[ti+2]=0,tb[ti+3]=0):(tb[ti]=fr,tb[ti+1]=fg,tb[ti+2]=fb,tb[ti+3]=fa)}else if(3==mode){var fa=sb[si+3],fr=sb[si],fg=sb[si+1],fb=sb[si+2],ba=tb[ti+3],br=tb[ti],bg=tb[ti+1],bb=tb[ti+2];if(fa==ba&&fr==br&&fg==bg&&fb==bb)continue;if(fa<220&&ba>20)return!1}return!0}return{decode:decode,toRGBA8:toRGBA8,_paeth:_paeth,_copyTile:_copyTile,_bin:_bin}}();!function(){var _copyTile=UPNG._copyTile,_bin=UPNG._bin,paeth=UPNG._paeth,crcLib={table:function(){for(var tab=new Uint32Array(256),n=0;n<256;n++){for(var c=n,k=0;k<8;k++)1&c?c=3988292384^c>>>1:c>>>=1;tab[n]=c}return tab}(),update:function(c,buf,off,len){for(var i=0;i<len;i++)c=crcLib.table[255&(c^buf[off+i])]^c>>>8;return c},crc:function(b,o,l){return 4294967295^crcLib.update(4294967295,b,o,l)}};function addErr(er,tg,ti,f){tg[ti]+=er[0]*f>>4,tg[ti+1]+=er[1]*f>>4,tg[ti+2]+=er[2]*f>>4,tg[ti+3]+=er[3]*f>>4}function N(x){return Math.max(0,Math.min(255,x))}function D(a,b){var dr=a[0]-b[0],dg=a[1]-b[1],db=a[2]-b[2],da=a[3]-b[3];return dr*dr+dg*dg+db*db+da*da}function dither(sb,w,h,plte,tb,oind,MTD){null==MTD&&(MTD=1);for(var pc=plte.length,nplt=[],rads=[],i=0;i<pc;i++){var c=plte[i];nplt.push([c>>>0&255,c>>>8&255,c>>>16&255,c>>>24&255])}for(var i=0;i<pc;i++){for(var ne=4294967295,ni=0,j=0;j<pc;j++){var ce=D(nplt[i],nplt[j]);j!=i&&ce<ne&&(ne=ce,ni=j)}var hd=Math.sqrt(ne)/2;rads[i]=~~(hd*hd)}for(var tb32=new Uint32Array(tb.buffer),err=new Int16Array(w*h*4),S=4,M=[0,8,2,10,12,4,14,6,3,11,1,9,15,7,13,5],i=0;i<M.length;i++)M[i]=255*((M[i]+.5)/16-.5);for(var y=0;y<h;y++)for(var x=0;x<w;x++){var i=4*(y*w+x),cc;if(2!=MTD)cc=[N(sb[i]+err[i]),N(sb[i+1]+err[i+1]),N(sb[i+2]+err[i+2]),N(sb[i+3]+err[i+3])];else{var ce=M[4*(3&y)+(3&x)];cc=[N(sb[i]+ce),N(sb[i+1]+ce),N(sb[i+2]+ce),N(sb[i+3]+ce)]}for(var ni=0,nd=16777215,j=0;j<pc;j++){var cd=D(cc,nplt[j]);cd<nd&&(nd=cd,ni=j)}var nc=nplt[ni],er=[cc[0]-nc[0],cc[1]-nc[1],cc[2]-nc[2],cc[3]-nc[3]];1==MTD&&(x!=w-1&&addErr(er,err,i+4,7),y!=h-1&&(0!=x&&addErr(er,err,i+4*w-4,3),addErr(er,err,i+4*w,5),x!=w-1&&addErr(er,err,i+4*w+4,1))),oind[i>>2]=ni,tb32[i>>2]=plte[ni]}}function encode(bufs,w,h,ps,dels,tabs,forbidPlte){null==ps&&(ps=0),null==forbidPlte&&(forbidPlte=!1);var nimg=compress(bufs,w,h,ps,[!1,!1,!1,0,forbidPlte,!1]);return compressPNG(nimg,-1),_main(nimg,w,h,dels,tabs)}function encodeLL(bufs,w,h,cc,ac,depth,dels,tabs){for(var nimg={ctype:0+(1==cc?0:2)+(0==ac?0:4),depth:depth,frames:[]},time=Date.now(),bipp=(cc+ac)*depth,bipl=bipp*w,i=0;i<bufs.length;i++)nimg.frames.push({rect:{x:0,y:0,width:w,height:h},img:new Uint8Array(bufs[i]),blend:0,dispose:1,bpp:Math.ceil(bipp/8),bpl:Math.ceil(bipl/8)});var out;return compressPNG(nimg,0,!0),_main(nimg,w,h,dels,tabs)}function _main(nimg,w,h,dels,tabs){null==tabs&&(tabs={});var crc=crcLib.crc,wUi=_bin.writeUint,wUs=_bin.writeUshort,wAs=_bin.writeASCII,offset=8,anim=nimg.frames.length>1,pltAlpha=!1,cicc,leng=33+(anim?20:0);if(null!=tabs.sRGB&&(leng+=13),null!=tabs.pHYs&&(leng+=21),null!=tabs.iCCP&&(leng+=21+(cicc=pako.deflate(tabs.iCCP)).length+4),3==nimg.ctype){for(var dl=nimg.plte.length,i=0;i<dl;i++)nimg.plte[i]>>>24!=255&&(pltAlpha=!0);leng+=8+3*dl+4+(pltAlpha?8+1*dl+4:0)}for(var j=0;j<nimg.frames.length;j++){var fr;anim&&(leng+=38),leng+=(fr=nimg.frames[j]).cimg.length+12,0!=j&&(leng+=4)}leng+=12;for(var data=new Uint8Array(leng),wr=[137,80,78,71,13,10,26,10],i=0;i<8;i++)data[i]=wr[i];if(wUi(data,offset,13),wAs(data,offset+=4,"IHDR"),wUi(data,offset+=4,w),wUi(data,offset+=4,h),data[offset+=4]=nimg.depth,data[++offset]=nimg.ctype,data[++offset]=0,data[++offset]=0,data[++offset]=0,wUi(data,++offset,crc(data,offset-17,17)),offset+=4,null!=tabs.sRGB&&(wUi(data,offset,1),wAs(data,offset+=4,"sRGB"),data[offset+=4]=tabs.sRGB,wUi(data,++offset,crc(data,offset-5,5)),offset+=4),null!=tabs.iCCP){var sl=13+cicc.length;wUi(data,offset,sl),wAs(data,offset+=4,"iCCP"),wAs(data,offset+=4,"ICC profile"),offset+=11,offset+=2,data.set(cicc,offset),wUi(data,offset+=cicc.length,crc(data,offset-(sl+4),sl+4)),offset+=4}if(null!=tabs.pHYs&&(wUi(data,offset,9),wAs(data,offset+=4,"pHYs"),wUi(data,offset+=4,tabs.pHYs[0]),wUi(data,offset+=4,tabs.pHYs[1]),data[offset+=4]=tabs.pHYs[2],wUi(data,++offset,crc(data,offset-13,13)),offset+=4),anim&&(wUi(data,offset,8),wAs(data,offset+=4,"acTL"),wUi(data,offset+=4,nimg.frames.length),wUi(data,offset+=4,null!=tabs.loop?tabs.loop:0),wUi(data,offset+=4,crc(data,offset-12,12)),offset+=4),3==nimg.ctype){var dl;wUi(data,offset,3*(dl=nimg.plte.length)),wAs(data,offset+=4,"PLTE"),offset+=4;for(var i=0;i<dl;i++){var ti=3*i,c=nimg.plte[i],r=255&c,g=c>>>8&255,b=c>>>16&255;data[offset+ti+0]=r,data[offset+ti+1]=g,data[offset+ti+2]=b}if(wUi(data,offset+=3*dl,crc(data,offset-3*dl-4,3*dl+4)),offset+=4,pltAlpha){wUi(data,offset,dl),wAs(data,offset+=4,"tRNS"),offset+=4;for(var i=0;i<dl;i++)data[offset+i]=nimg.plte[i]>>>24&255;wUi(data,offset+=dl,crc(data,offset-dl-4,dl+4)),offset+=4}}for(var fi=0,j=0;j<nimg.frames.length;j++){var fr=nimg.frames[j];anim&&(wUi(data,offset,26),wAs(data,offset+=4,"fcTL"),wUi(data,offset+=4,fi++),wUi(data,offset+=4,fr.rect.width),wUi(data,offset+=4,fr.rect.height),wUi(data,offset+=4,fr.rect.x),wUi(data,offset+=4,fr.rect.y),wUs(data,offset+=4,dels[j]),wUs(data,offset+=2,1e3),data[offset+=2]=fr.dispose,data[++offset]=fr.blend,wUi(data,++offset,crc(data,offset-30,30)),offset+=4);var imgd=fr.cimg,dl;wUi(data,offset,(dl=imgd.length)+(0==j?0:4));var ioff=offset+=4;wAs(data,offset,0==j?"IDAT":"fdAT"),offset+=4,0!=j&&(wUi(data,offset,fi++),offset+=4),data.set(imgd,offset),wUi(data,offset+=dl,crc(data,ioff,offset-ioff)),offset+=4}return wUi(data,offset,0),wAs(data,offset+=4,"IEND"),wUi(data,offset+=4,crc(data,offset-4,4)),offset+=4,data.buffer}function compressPNG(out,filter,levelZero){for(var i=0;i<out.frames.length;i++){var frm=out.frames[i],nw=frm.rect.width,nh=frm.rect.height,fdata=new Uint8Array(nh*frm.bpl+nh);frm.cimg=_filterZero(frm.img,nh,frm.bpp,frm.bpl,fdata,filter,levelZero)}}function compress(bufs,w,h,ps,prms){for(var onlyBlend=prms[0],evenCrd=prms[1],forbidPrev=prms[2],minBits=prms[3],forbidPlte=prms[4],dith=prms[5],ctype=6,depth=8,alphaAnd=255,j=0;j<bufs.length;j++)for(var img=new Uint8Array(bufs[j]),ilen=img.length,i=0;i<ilen;i+=4)alphaAnd&=img[i+3];var gotAlpha=255!=alphaAnd,frms=framize(bufs,w,h,onlyBlend,evenCrd,forbidPrev),cmap={},plte=[],inds=[];if(0!=ps){for(var nbufs=[],i=0;i<frms.length;i++)nbufs.push(frms[i].img.buffer);for(var abuf,qres=quantize(concatRGBA(nbufs),ps),i=0;i<qres.plte.length;i++)plte.push(qres.plte[i].est.rgba);for(var cof=0,i=0;i<frms.length;i++){var frm,bln=(frm=frms[i]).img.length,ind=new Uint8Array(qres.inds.buffer,cof>>2,bln>>2);inds.push(ind);var bb=new Uint8Array(qres.abuf,cof,bln);dith&&dither(frm.img,frm.rect.width,frm.rect.height,plte,bb,ind),frm.img.set(bb),cof+=bln}}else for(var j=0;j<frms.length;j++){var frm=frms[j],img32=new Uint32Array(frm.img.buffer),nw=frm.rect.width,ilen=img32.length,ind=new Uint8Array(ilen);inds.push(ind);for(var i=0;i<ilen;i++){var c=img32[i];if(0!=i&&c==img32[i-1])ind[i]=ind[i-1];else if(i>nw&&c==img32[i-nw])ind[i]=ind[i-nw];else{var cmc=cmap[c];if(null==cmc&&(cmap[c]=cmc=plte.length,plte.push(c),plte.length>=300))break;ind[i]=cmc}}}var cc=plte.length;cc<=256&&0==forbidPlte&&(depth=cc<=2?1:cc<=4?2:cc<=16?4:8,depth=Math.max(depth,minBits));for(var j=0;j<frms.length;j++){var frm,nx=(frm=frms[j]).rect.x,ny=frm.rect.y,nw=frm.rect.width,nh=frm.rect.height,cimg=frm.img,cimg32=new Uint32Array(cimg.buffer),bpl=4*nw,bpp=4;if(cc<=256&&0==forbidPlte){bpl=Math.ceil(depth*nw/8);for(var nimg=new Uint8Array(bpl*nh),inj=inds[j],y=0;y<nh;y++){var i=y*bpl,ii=y*nw;if(8==depth)for(var x=0;x<nw;x++)nimg[i+x]=inj[ii+x];else if(4==depth)for(var x=0;x<nw;x++)nimg[i+(x>>1)]|=inj[ii+x]<<4-4*(1&x);else if(2==depth)for(var x=0;x<nw;x++)nimg[i+(x>>2)]|=inj[ii+x]<<6-2*(3&x);else if(1==depth)for(var x=0;x<nw;x++)nimg[i+(x>>3)]|=inj[ii+x]<<7-1*(7&x)}cimg=nimg,ctype=3,bpp=1}else if(0==gotAlpha&&1==frms.length){for(var nimg=new Uint8Array(nw*nh*3),area=nw*nh,i=0;i<area;i++){var ti=3*i,qi=4*i;nimg[ti]=cimg[qi],nimg[ti+1]=cimg[qi+1],nimg[ti+2]=cimg[qi+2]}cimg=nimg,ctype=2,bpp=3,bpl=3*nw}frm.img=cimg,frm.bpl=bpl,frm.bpp=bpp}return{ctype:ctype,depth:depth,plte:plte,frames:frms}}function framize(bufs,w,h,alwaysBlend,evenCrd,forbidPrev){for(var frms=[],j=0;j<bufs.length;j++){var cimg=new Uint8Array(bufs[j]),cimg32=new Uint32Array(cimg.buffer),nimg,nx=0,ny=0,nw=w,nh=h,blend=alwaysBlend?1:0;if(0!=j){for(var tlim=forbidPrev||alwaysBlend||1==j||0!=frms[j-2].dispose?1:2,tstp=0,tarea=1e9,it=0;it<tlim;it++){for(var pimg=new Uint8Array(bufs[j-1-it]),p32=new Uint32Array(bufs[j-1-it]),mix=w,miy=h,max=-1,may=-1,y=0;y<h;y++)for(var x=0;x<w;x++){var i;cimg32[i=y*w+x]!=p32[i]&&(x<mix&&(mix=x),x>max&&(max=x),y<miy&&(miy=y),y>may&&(may=y))}-1==max&&(mix=miy=max=may=0),evenCrd&&(1==(1&mix)&&mix--,1==(1&miy)&&miy--);var sarea=(max-mix+1)*(may-miy+1);sarea<tarea&&(tarea=sarea,tstp=it,nx=mix,ny=miy,nw=max-mix+1,nh=may-miy+1)}var pimg=new Uint8Array(bufs[j-1-tstp]);1==tstp&&(frms[j-1].dispose=2),nimg=new Uint8Array(nw*nh*4),_copyTile(pimg,w,h,nimg,nw,nh,-nx,-ny,0),1==(blend=_copyTile(cimg,w,h,nimg,nw,nh,-nx,-ny,3)?1:0)?_prepareDiff(cimg,w,h,nimg,{x:nx,y:ny,width:nw,height:nh}):_copyTile(cimg,w,h,nimg,nw,nh,-nx,-ny,0)}else nimg=cimg.slice(0);frms.push({rect:{x:nx,y:ny,width:nw,height:nh},img:nimg,blend:blend,dispose:0})}if(alwaysBlend)for(var j=0;j<frms.length;j++){var frm;if(1!=(frm=frms[j]).blend){var r0=frm.rect,r1=frms[j-1].rect,miX=Math.min(r0.x,r1.x),miY=Math.min(r0.y,r1.y),maX,maY,r={x:miX,y:miY,width:Math.max(r0.x+r0.width,r1.x+r1.width)-miX,height:Math.max(r0.y+r0.height,r1.y+r1.height)-miY};frms[j-1].dispose=1,j-1!=0&&_updateFrame(bufs,w,h,frms,j-1,r,evenCrd),_updateFrame(bufs,w,h,frms,j,r,evenCrd)}}var area=0;if(1!=bufs.length)for(var i=0;i<frms.length;i++){var frm;area+=(frm=frms[i]).rect.width*frm.rect.height}return frms}function _updateFrame(bufs,w,h,frms,i,r,evenCrd){for(var U8=Uint8Array,U32=Uint32Array,pimg=new U8(bufs[i-1]),pimg32=new U32(bufs[i-1]),nimg=i+1<bufs.length?new U8(bufs[i+1]):null,cimg=new U8(bufs[i]),cimg32=new U32(cimg.buffer),mix=w,miy=h,max=-1,may=-1,y=0;y<r.height;y++)for(var x=0;x<r.width;x++){var cx=r.x+x,cy=r.y+y,j=cy*w+cx,cc=cimg32[j];0==cc||0==frms[i-1].dispose&&pimg32[j]==cc&&(null==nimg||0!=nimg[4*j+3])||(cx<mix&&(mix=cx),cx>max&&(max=cx),cy<miy&&(miy=cy),cy>may&&(may=cy))}-1==max&&(mix=miy=max=may=0),evenCrd&&(1==(1&mix)&&mix--,1==(1&miy)&&miy--),r={x:mix,y:miy,width:max-mix+1,height:may-miy+1};var fr=frms[i];fr.rect=r,fr.blend=1,fr.img=new Uint8Array(r.width*r.height*4),0==frms[i-1].dispose?(_copyTile(pimg,w,h,fr.img,r.width,r.height,-r.x,-r.y,0),_prepareDiff(cimg,w,h,fr.img,r)):_copyTile(cimg,w,h,fr.img,r.width,r.height,-r.x,-r.y,0)}function _prepareDiff(cimg,w,h,nimg,rec){_copyTile(cimg,w,h,nimg,rec.width,rec.height,-rec.x,-rec.y,2)}function _filterZero(img,h,bpp,bpl,data,filter,levelZero){var fls=[],ftry=[0,1,2,3,4],opts;-1!=filter?ftry=[filter]:(h*bpl>5e5||1==bpp)&&(ftry=[0]),levelZero&&(opts={level:0});for(var CMPR=data.length>1e7&&null!=window.UZIP?window.UZIP:pako,time=Date.now(),i=0;i<ftry.length;i++){for(var y=0;y<h;y++)_filterLine(data,img,y,bpl,bpp,ftry[i]);fls.push(CMPR.deflate(data,opts))}for(var ti,tsize=1e9,i=0;i<fls.length;i++)fls[i].length<tsize&&(ti=i,tsize=fls[i].length);return fls[ti]}function _filterLine(data,img,y,bpl,bpp,type){var i=y*bpl,di=i+y;if(data[di]=type,di++,0==type)if(bpl<500)for(var x=0;x<bpl;x++)data[di+x]=img[i+x];else data.set(new Uint8Array(img.buffer,i,bpl),di);else if(1==type){for(var x=0;x<bpp;x++)data[di+x]=img[i+x];for(var x=bpp;x<bpl;x++)data[di+x]=img[i+x]-img[i+x-bpp]+256&255}else if(0==y){for(var x=0;x<bpp;x++)data[di+x]=img[i+x];if(2==type)for(var x=bpp;x<bpl;x++)data[di+x]=img[i+x];if(3==type)for(var x=bpp;x<bpl;x++)data[di+x]=img[i+x]-(img[i+x-bpp]>>1)+256&255;if(4==type)for(var x=bpp;x<bpl;x++)data[di+x]=img[i+x]-paeth(img[i+x-bpp],0,0)+256&255}else{if(2==type)for(var x=0;x<bpl;x++)data[di+x]=img[i+x]+256-img[i+x-bpl]&255;if(3==type){for(var x=0;x<bpp;x++)data[di+x]=img[i+x]+256-(img[i+x-bpl]>>1)&255;for(var x=bpp;x<bpl;x++)data[di+x]=img[i+x]+256-(img[i+x-bpl]+img[i+x-bpp]>>1)&255}if(4==type){for(var x=0;x<bpp;x++)data[di+x]=img[i+x]+256-paeth(0,img[i+x-bpl],0)&255;for(var x=bpp;x<bpl;x++)data[di+x]=img[i+x]+256-paeth(img[i+x-bpp],img[i+x-bpl],img[i+x-bpp-bpl])&255}}}function quantize(abuf,ps){var sb=new Uint8Array(abuf),tb=sb.slice(0),tb32=new Uint32Array(tb.buffer),KD=getKDtree(tb,ps),root=KD[0],leafs=KD[1],len=sb.length,inds=new Uint8Array(len>>2),nd;if(sb.length<2e7)for(var i=0;i<len;i+=4){var r,g,b,a;nd=getNearest(root,r=sb[i]*(1/255),g=sb[i+1]*(1/255),b=sb[i+2]*(1/255),a=sb[i+3]*(1/255)),inds[i>>2]=nd.ind,tb32[i>>2]=nd.est.rgba}else for(var i=0;i<len;i+=4){var r=sb[i]*(1/255),g=sb[i+1]*(1/255),b=sb[i+2]*(1/255),a=sb[i+3]*(1/255);for(nd=root;nd.left;)nd=planeDst(nd.est,r,g,b,a)<=0?nd.left:nd.right;inds[i>>2]=nd.ind,tb32[i>>2]=nd.est.rgba}return{abuf:tb.buffer,inds:inds,plte:leafs}}function getKDtree(nimg,ps,err){null==err&&(err=1e-4);var nimg32=new Uint32Array(nimg.buffer),root={i0:0,i1:nimg.length,bst:null,est:null,tdst:0,left:null,right:null};root.bst=stats(nimg,root.i0,root.i1),root.est=estats(root.bst);for(var leafs=[root];leafs.length<ps;){for(var maxL=0,mi=0,i=0;i<leafs.length;i++)leafs[i].est.L>maxL&&(maxL=leafs[i].est.L,mi=i);if(maxL<err)break;var node=leafs[mi],s0=splitPixels(nimg,nimg32,node.i0,node.i1,node.est.e,node.est.eMq255),s0wrong;if(node.i0>=s0||node.i1<=s0)node.est.L=0;else{var ln={i0:node.i0,i1:s0,bst:null,est:null,tdst:0,left:null,right:null};ln.bst=stats(nimg,ln.i0,ln.i1),ln.est=estats(ln.bst);var rn={i0:s0,i1:node.i1,bst:null,est:null,tdst:0,left:null,right:null};rn.bst={R:[],m:[],N:node.bst.N-ln.bst.N};for(var i=0;i<16;i++)rn.bst.R[i]=node.bst.R[i]-ln.bst.R[i];for(var i=0;i<4;i++)rn.bst.m[i]=node.bst.m[i]-ln.bst.m[i];rn.est=estats(rn.bst),node.left=ln,node.right=rn,leafs[mi]=ln,leafs.push(rn)}}leafs.sort((function(a,b){return b.bst.N-a.bst.N}));for(var i=0;i<leafs.length;i++)leafs[i].ind=i;return[root,leafs]}function getNearest(nd,r,g,b,a){if(null==nd.left)return nd.tdst=dist(nd.est.q,r,g,b,a),nd;var pd=planeDst(nd.est,r,g,b,a),node0=nd.left,node1=nd.right;pd>0&&(node0=nd.right,node1=nd.left);var ln=getNearest(node0,r,g,b,a);if(ln.tdst<=pd*pd)return ln;var rn=getNearest(node1,r,g,b,a);return rn.tdst<ln.tdst?rn:ln}function planeDst(est,r,g,b,a){var e=est.e;return e[0]*r+e[1]*g+e[2]*b+e[3]*a-est.eMq}function dist(q,r,g,b,a){var d0=r-q[0],d1=g-q[1],d2=b-q[2],d3=a-q[3];return d0*d0+d1*d1+d2*d2+d3*d3}function splitPixels(nimg,nimg32,i0,i1,e,eMq){i1-=4;for(var shfs=0;i0<i1;){for(;vecDot(nimg,i0,e)<=eMq;)i0+=4;for(;vecDot(nimg,i1,e)>eMq;)i1-=4;if(i0>=i1)break;var t=nimg32[i0>>2];nimg32[i0>>2]=nimg32[i1>>2],nimg32[i1>>2]=t,i0+=4,i1-=4}for(;vecDot(nimg,i0,e)>eMq;)i0-=4;return i0+4}function vecDot(nimg,i,e){return nimg[i]*e[0]+nimg[i+1]*e[1]+nimg[i+2]*e[2]+nimg[i+3]*e[3]}function stats(nimg,i0,i1){for(var R=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],m=[0,0,0,0],N=i1-i0>>2,i=i0;i<i1;i+=4){var r=nimg[i]*(1/255),g=nimg[i+1]*(1/255),b=nimg[i+2]*(1/255),a=nimg[i+3]*(1/255);m[0]+=r,m[1]+=g,m[2]+=b,m[3]+=a,R[0]+=r*r,R[1]+=r*g,R[2]+=r*b,R[3]+=r*a,R[5]+=g*g,R[6]+=g*b,R[7]+=g*a,R[10]+=b*b,R[11]+=b*a,R[15]+=a*a}return R[4]=R[1],R[8]=R[2],R[9]=R[6],R[12]=R[3],R[13]=R[7],R[14]=R[11],{R:R,m:m,N:N}}function estats(stats){var R=stats.R,m=stats.m,N=stats.N,m0=m[0],m1=m[1],m2=m[2],m3=m[3],iN=0==N?0:1/N,Rj=[R[0]-m0*m0*iN,R[1]-m0*m1*iN,R[2]-m0*m2*iN,R[3]-m0*m3*iN,R[4]-m1*m0*iN,R[5]-m1*m1*iN,R[6]-m1*m2*iN,R[7]-m1*m3*iN,R[8]-m2*m0*iN,R[9]-m2*m1*iN,R[10]-m2*m2*iN,R[11]-m2*m3*iN,R[12]-m3*m0*iN,R[13]-m3*m1*iN,R[14]-m3*m2*iN,R[15]-m3*m3*iN],A=Rj,M=M4,b=[Math.random(),Math.random(),Math.random(),Math.random()],mi=0,tmi=0;if(0!=N)for(var i=0;i<16&&(b=M.multVec(A,b),tmi=Math.sqrt(M.dot(b,b)),b=M.sml(1/tmi,b),!(0!=i&&Math.abs(tmi-mi)<1e-9));i++)mi=tmi;var q=[m0*iN,m1*iN,m2*iN,m3*iN],eMq255;return{Cov:Rj,q:q,e:b,L:mi,eMq255:M.dot(M.sml(255,q),b),eMq:M.dot(b,q),rgba:(Math.round(255*q[3])<<24|Math.round(255*q[2])<<16|Math.round(255*q[1])<<8|Math.round(255*q[0])<<0)>>>0}}var M4={multVec:function(m,v){return[m[0]*v[0]+m[1]*v[1]+m[2]*v[2]+m[3]*v[3],m[4]*v[0]+m[5]*v[1]+m[6]*v[2]+m[7]*v[3],m[8]*v[0]+m[9]*v[1]+m[10]*v[2]+m[11]*v[3],m[12]*v[0]+m[13]*v[1]+m[14]*v[2]+m[15]*v[3]]},dot:function(x,y){return x[0]*y[0]+x[1]*y[1]+x[2]*y[2]+x[3]*y[3]},sml:function(a,y){return[a*y[0],a*y[1],a*y[2],a*y[3]]}};function concatRGBA(bufs){for(var tlen=0,i=0;i<bufs.length;i++)tlen+=bufs[i].byteLength;for(var nimg=new Uint8Array(tlen),noff=0,i=0;i<bufs.length;i++){for(var img=new Uint8Array(bufs[i]),il=img.length,j=0;j<il;j+=4){var r=img[j],g=img[j+1],b=img[j+2],a=img[j+3];0==a&&(r=g=b=0),nimg[noff+j]=r,nimg[noff+j+1]=g,nimg[noff+j+2]=b,nimg[noff+j+3]=a}noff+=il}return nimg.buffer}UPNG.encode=encode,UPNG.encodeLL=encodeLL,UPNG.encode.compress=compress,UPNG.encode.dither=dither,UPNG.quantize=quantize,UPNG.quantize.getKDtree=getKDtree,UPNG.quantize.getNearest=getNearest}();